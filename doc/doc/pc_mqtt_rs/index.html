<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Process Control Hyperdrive MQTT project (Rust version)"><title>pc_mqtt_rs - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-9bb858ba049f1f21.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="pc_mqtt_rs" data-themes="" data-resource-suffix="" data-rustdoc-version="1.72.0 (5680fa18f 2023-08-23)" data-channel="1.72.0" data-search-js="search-f6292fe389d70017.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ><script src="../static.files/storage-59fd9b8ccb335783.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../pc_mqtt_rs/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../pc_mqtt_rs/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate pc_mqtt_rs</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.1.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‚ÄòS‚Äô to search, ‚Äò?‚Äô for more options‚Ä¶" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">pc_mqtt_rs</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/pc_mqtt_rs/lib.rs.html#1-46">source</a> ¬∑ <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Process Control Hyperdrive MQTT project (Rust version)</p>
<p>This documentation can either be read from the source code or by using the ‚Äúindex.html‚Äù (recommended). The latter was generated using ‚Äúcargo doc‚Äù and can be found in the ‚Äúdocs‚Äù folder. </p>
<p>The project consists of 4 parts:</p>
<ul>
<li>Steering controller (blink, speed, lane)</li>
<li>Emergency controller (relay)</li>
<li>Track the tracks controller (track, relay)</li>
<li>Personal addition (track, relay)</li>
</ul>
<p>All client implementations is found within the client module and shared code is found within the library module.</p>
<h2 id="available-controllersclients"><a href="#available-controllersclients">Available controllers/clients</a></h2>
<p>Each client module has a struct that holds some data about its purpose and a vehicle list. They all initialize a new MQTT client and run in their own thread.
Since all the communication is done through MQTT, they can be mixed and matched with their counterparts written in Python.
The only limitation being that the relay client needs to be started before any other client, to avoid lost connect messages.</p>
<h3 id="steering-controllers"><a href="#steering-controllers">Steering controllers</a></h3><h4 id="blink"><a href="#blink">Blink</a></h4>
<p>Every second it sends a message to each vehicle setting their lights to either on or off.</p>
<h4 id="speed"><a href="#speed">Speed</a></h4>
<p>Every 3 seconds it sends a message to set the speed of each vehicle. The speed values are given to the controller with a list, and is iterated.</p>
<h4 id="lane"><a href="#lane">Lane</a></h4>
<p>Every 5 seconds it sends a message to change lane of each vehicle by iterating a list of values given as an argument.</p>
<h3 id="emergency-controller"><a href="#emergency-controller">Emergency controller</a></h3>
<p>Both the emergency and personal addition controllers are implemented inside the relay module/client.
The relay client is responsible for relaying messages from every other client to the broker. It will also handle emergency messages and personal addition (zone) messages, and if necessary overwrite any speed messages.</p>
<h3 id="tracking-and-personal-addition-controllers"><a href="#tracking-and-personal-addition-controllers">Tracking and personal addition controllers</a></h3>
<p>It receives and stores track ID numbers for each vehicle.
If a vehicle is on a track that has a speed limit (velocity 200), it is appended to ‚Äúslow_vehicles‚Äù list and published for the relay to take action.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="client/index.html" title="mod pc_mqtt_rs::client">client</a><span title="Restricted Visibility">&nbsp;üîí</span> </div></li><li><div class="item-name"><a class="mod" href="library/index.html" title="mod pc_mqtt_rs::library">library</a><span title="Restricted Visibility">&nbsp;üîí</span> </div></li></ul><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Blink.html" title="struct pc_mqtt_rs::Blink">Blink</a></div><div class="desc docblock-short">Holds the current state and a list of vehicles.</div></li><li><div class="item-name"><a class="struct" href="struct.ClientWrapper.html" title="struct pc_mqtt_rs::ClientWrapper">ClientWrapper</a></div><div class="desc docblock-short">Rumqttc client wrapper, wraps the client in an Arc&lt;Mutex&lt;&gt;&gt; to allow sharing it between threads safely.</div></li><li><div class="item-name"><a class="struct" href="struct.ConnectionWrapper.html" title="struct pc_mqtt_rs::ConnectionWrapper">ConnectionWrapper</a></div></li><li><div class="item-name"><a class="struct" href="struct.Lane.html" title="struct pc_mqtt_rs::Lane">Lane</a></div><div class="desc docblock-short">Struct holding the offsets and a list of vehicles.</div></li><li><div class="item-name"><a class="struct" href="struct.Mqtt.html" title="struct pc_mqtt_rs::Mqtt">Mqtt</a></div></li><li><div class="item-name"><a class="struct" href="struct.Relay.html" title="struct pc_mqtt_rs::Relay">Relay</a></div><div class="desc docblock-short">The Relay struct holds a list of vehicle IDs, the emergency state, a list of vehicles inside a slow zone, and the last speed value.</div></li><li><div class="item-name"><a class="struct" href="struct.Speed.html" title="struct pc_mqtt_rs::Speed">Speed</a></div><div class="desc docblock-short">Struct holding lists of velocities and vehicles.</div></li><li><div class="item-name"><a class="struct" href="struct.Track.html" title="struct pc_mqtt_rs::Track">Track</a></div></li></ul><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.Payload.html" title="enum pc_mqtt_rs::Payload">Payload</a></div><div class="desc docblock-short">An enum that holds most of the payloads/messagess used in the project.</div></li><li><div class="item-name"><a class="enum" href="enum.Topic.html" title="enum pc_mqtt_rs::Topic">Topic</a></div><div class="desc docblock-short">An enum that holds almost all the topics used in the project.</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.blocking_emergency_handler.html" title="fn pc_mqtt_rs::blocking_emergency_handler">blocking_emergency_handler</a></div><div class="desc docblock-short">Blocks thread and publishes emergency messages on the keypress of enter.</div></li><li><div class="item-name"><a class="fn" href="fn.connect_vehicles.html" title="fn pc_mqtt_rs::connect_vehicles">connect_vehicles</a></div><div class="desc docblock-short">Sends Connect(true) to each vehicle.</div></li><li><div class="item-name"><a class="fn" href="fn.discover_vehicles.html" title="fn pc_mqtt_rs::discover_vehicles">discover_vehicles</a></div><div class="desc docblock-short">Asks for discovered vehicle IDs and prints them to stdout.</div></li><li><div class="item-name"><a class="fn" href="fn.set_ctrlc_handler.html" title="fn pc_mqtt_rs::set_ctrlc_handler">set_ctrlc_handler</a></div><div class="desc docblock-short">Sets up a handler to disconnect vehicles on CTRL+C.</div></li></ul></section></div></main></body></html>